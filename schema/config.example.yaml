# CoreGuard Configuration Schema
# ================================
# Pipeline-agnostic SNP comparison tool
#
# Usage: coreguard compare --config project.yaml -o report.json

# Reference genome (required)
reference:
  path: reference.fasta
  label: "Reference Genome"  # optional, shown in UI

# Samples definition
# - key: internal ID (used for matching across pipelines)
# - label: display name in UI (optional)
# - reads: FASTQ files for baseline alignment (optional)
samples:
  Sample1:
    label: "Outbreak Sample A"
    reads:
      - fastq/Sample1_R1.fq.gz
      - fastq/Sample1_R2.fq.gz

  Sample2:
    label: "Outbreak Sample B"
    reads:
      - fastq/Sample2_R1.fq.gz
      - fastq/Sample2_R2.fq.gz

  Sample3:
    label: "Control Sample"
    # no reads = no baseline alignment for this sample

# Pipeline definitions
# - key: internal pipeline ID
# - label: display name in UI (optional)
# - samples: mapping of sample_id -> files
#   - vcf: VCF file (optional) -> shows SNPs
#   - bam: BAM file (optional) -> shows gaps/coverage
pipelines:
  # Example 1: Aligner only (no variant calling) - marked as ground truth
  minimap2:
    label: "minimap2 baseline"
    command: "minimap2 -ax sr reference.fasta reads_R1.fq.gz reads_R2.fq.gz | samtools sort -o output.bam"
    ground_truth: true  # This pipeline is used as the baseline for comparison
    samples:
      Sample1:
        bam: alignments/Sample1.bam
      Sample2:
        bam: alignments/Sample2.bam
      Sample3:
        bam: alignments/Sample3.bam

  # Example 2: Full pipeline with VCF + BAM
  snippy:
    label: "Snippy v4.6"
    command: "snippy --cpus 8 --outdir out --ref reference.fasta --R1 reads_R1.fq.gz --R2 reads_R2.fq.gz"
    samples:
      Sample1:
        vcf: snippy/Sample1/snps.vcf
        bam: snippy/Sample1/snps.bam
      Sample2:
        vcf: snippy/Sample2/snps.vcf
        bam: snippy/Sample2/snps.bam
      Sample3:
        vcf: snippy/Sample3/snps.vcf
        bam: snippy/Sample3/snps.bam

  # Example 3: VCF only (no BAM)
  cfsan:
    label: "CFSAN SNP Pipeline"
    command: "cfsan_snp_pipeline run -m soft -o output reference.fasta samples/"
    samples:
      Sample1:
        vcf: cfsan/Sample1/var.flt.vcf
      Sample2:
        vcf: cfsan/Sample2/var.flt.vcf
      Sample3:
        vcf: cfsan/Sample3/var.flt.vcf

  # Example 4: Custom pipeline (partial samples)
  gatk:
    label: "GATK HaplotypeCaller"
    command: "gatk HaplotypeCaller -R reference.fasta -I input.bam -O output.vcf"
    samples:
      Sample1:
        vcf: gatk/Sample1.g.vcf
        bam: gatk/Sample1.dedup.bam

# Options (optional)
options:
  min_depth: 1          # minimum depth to consider position covered
  min_qual: 20          # minimum SNP quality to include
  include_indels: false # include insertions/deletions (default: false)
